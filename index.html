async function solicitarMakroApoyo() {
    const dniRuc = document.getElementById('dniRuc').value;
    const clientes = await loadClientes();
    const cliente = clientes.find(c => c["ID Titular"].toString() === dniRuc); // Cambiado a string

    const resultDiv = document.getElementById('result');

    if (cliente) {
        const fechaActual = new Date().toLocaleDateString('es-ES');
        const horaActual = new Date().toLocaleTimeString('es-ES');

        document.getElementById('dniRuc').style.display = 'none';
        document.getElementById('btnSolicitar').style.display = 'none';
        document.getElementById('introText').style.display = 'none';

        resultDiv.innerHTML = `<div class="dni-ruc-display">${dniRuc}</div>
                               <h2>¡Bienvenido!</h2>
                               <p>Nombre: ${cliente["Nombre/Razon Social"]}</p>
                               <p>Local: ${cliente["Nombre_Local"]}</p>
                               <p>Fecha: ${fechaActual}</p>
                               <p>Hora: ${horaActual}</p>
                               <p class="footer-message">Mostrar esta imagen en el lineal de cajas</p>`;

        const dataToSend = {
            dniRuc: dniRuc,
            nombreLocal: cliente["Nombre_Local"],
            nombreRazonSocial: cliente["Nombre/Razon Social"], // Asegúrate de que coincida con el nombre
            fecha: fechaActual,
            hora: horaActual,
        };

        const scriptURL = 'https://script.google.com/macros/s/AKfycby8QCuC-2fCNQNDZ_7MjeQZwTtVxqNWm8139PgRXHMUKsCAT4DWwYW2Kft4WeV1g4AJ/exec';

        fetch(scriptURL, {
            method: 'POST',
            body: new URLSearchParams(dataToSend),
            headers: {
                'Content-Type': 'application/x-www-form-urlencoded'
            }
        })
        .then(response => response.json())
        .then(data => console.log('Success:', data))
        .catch((error) => console.error('Error:', error));

    } else {
        resultDiv.innerHTML = `<p style="color: red;">Documento no encontrado. Consulte en SAC.</p>`;
    }
}
